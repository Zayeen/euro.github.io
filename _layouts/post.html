---
layout: default
---
<article class="post-content">
    <div class="post-header">
        <div class="post-meta">
            <span class="post-date">{{ page.date | date: "%B %d, %Y" }}</span>
            {% assign words = content | number_of_words %}
            {% assign read_time = words | divided_by: 180 | plus: 1 %}
            <span class="read-time">⏱️ {{ read_time }} min read</span>
            {% if page.tags %}
                {% for tag in page.tags %}
                <span class="post-tag">{{ tag }}</span>
                {% endfor %}
            {% endif %}
        </div>
        <h1>{{ page.title }}</h1>
    </div>
    
    <div class="post-body" id="post-body">
        {{ content }}
    </div>

    <div class="post-footer">
        <div class="share-buttons">
            <span>Share this experiment:</span>
            <a href="https://twitter.com/intent/tweet?text={{ page.title | url_encode }}&url={{ site.url }}{{ page.url }}" target="_blank" rel="noopener noreferrer" class="share-btn">Twitter</a>
            <a href="https://www.linkedin.com/shareArticle?mini=true&url={{ site.url }}{{ page.url }}&title={{ page.title | url_encode }}" target="_blank" rel="noopener noreferrer" class="share-btn">LinkedIn</a>
        </div>
    </div>

    {% assign related_posts_count = 0 %}
    {% for post in site.posts %}
        {% if post.url != page.url %}
            {% for tag in post.tags %}
                {% if page.tags contains tag %}
                    {% assign related_posts_count = related_posts_count | plus: 1 %}
                    {% break %}
                {% endif %}
            {% endfor %}
        {% endif %}
    {% endfor %}

    {% if related_posts_count > 0 %}
    <div class="related-posts">
        <h3>Related Experiments</h3>
        <div class="related-grid">
            {% assign shown_count = 0 %}
            {% for post in site.posts %}
                {% if post.url != page.url and shown_count < 3 %}
                    {% assign common_tag = false %}
                    {% for tag in post.tags %}
                        {% if page.tags contains tag %}
                            {% assign common_tag = true %}
                            {% break %}
                        {% endif %}
                    {% endfor %}

                    {% if common_tag %}
                        <article class="post-card">
                            <div class="post-meta">
                                <span class="post-date">{{ post.date | date: "%B %d, %Y" }}</span>
                            </div>
                            <h3><a href="{{ post.url | relative_url }}">{{ post.title }}</a></h3>
                            <a href="{{ post.url | relative_url }}" class="read-more">Read Experiment ➜</a>
                        </article>
                        {% assign shown_count = shown_count | plus: 1 %}
                    {% endif %}
                {% endif %}
            {% endfor %}
        </div>
    </div>
    {% endif %}
</article>

<button id="back-to-top" class="back-to-top" aria-label="Back to top">↑</button>

<script>
    const backToTop = document.getElementById('back-to-top');
    window.addEventListener('scroll', () => {
        if (window.scrollY > 500) {
            backToTop.classList.add('visible');
        } else {
            backToTop.classList.remove('visible');
        }
    });
    backToTop.addEventListener('click', () => {
        window.scrollTo({ top: 0, behavior: 'smooth' });
    });

    // TOC Generation
    const postBody = document.getElementById('post-body');
    if (postBody) {
        const headings = postBody.querySelectorAll('h2, h3');
        if (headings.length > 3) {
            const toc = document.createElement('div');
            toc.className = 'table-of-contents';
            toc.innerHTML = '<h4>Jump to Section</h4><ul></ul>';
            const ul = toc.querySelector('ul');
            
            headings.forEach((heading, index) => {
                const id = 'heading-' + index;
                heading.setAttribute('id', id);
                const li = document.createElement('li');
                li.style.paddingLeft = heading.tagName === 'H3' ? '1rem' : '0';
                const a = document.createElement('a');
                a.href = '#' + id;
                a.textContent = heading.textContent;
                li.appendChild(a);
                ul.appendChild(li);
            });
            
            postBody.insertBefore(toc, postBody.firstChild);
        }
    }
</script>

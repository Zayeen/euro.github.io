---
layout: default
title: Home
---

<div class="dashboard-container">
    <!-- 1. Intro Module -->
    <div class="dash-module dash-intro">
        <div class="module-header">
            <span class="status-indicator"></span>
            <span class="module-title">SYSTEM STATUS: ONLINE</span>
        </div>
        <div class="intro-content">
            <h1>The IoT Lab</h1>
            <p>Experiments in smart home security, automation, and the connected future.</p>
            <div class="action-row">
                <a href="#feed" class="btn-primary">Initialize Protocol</a>
                <a href="{{ '/about.html' | relative_url }}" class="btn-secondary">View Specs</a>
            </div>
        </div>
    </div>

    <!-- 2. Tech Capabilities Module -->
    <div class="dash-module dash-tech">
        <div class="module-header">
            <span class="module-title">ACTIVE PROTOCOLS</span>
        </div>
        <div class="tech-tags-grid">
            <span class="tech-tag" data-type="protocol">ZIGBEE 3.0</span>
            <span class="tech-tag" data-type="protocol">MATTER</span>
            <span class="tech-tag" data-type="protocol">ZWAVE LR</span>
            <span class="tech-tag" data-type="network">WI-FI 6</span>
            <span class="tech-tag" data-type="network">THREAD</span>
            <span class="tech-tag" data-type="system">HOME ASSISTANT</span>
            <span class="tech-tag" data-type="system">NODE-RED</span>
            <span class="tech-tag" data-type="system">MQTT</span>
            <span class="tech-tag" data-type="hardware">ESP32</span>
        </div>
    </div>

    <!-- 3. Search & Filter Module -->
    <div class="dash-module dash-filter">
        <div class="search-bar">
            <span class="search-icon">>_</span>
            <input type="text" id="search-input" placeholder="SEARCH DATABASE..." aria-label="Search">
        </div>
        <div class="filter-row">
            <button class="filter-btn active" data-tag="all">ALL</button>
            <button class="filter-btn" data-tag="Security">SEC</button>
            <button class="filter-btn" data-tag="Automation">AUTO</button>
            <button class="filter-btn" data-tag="Hardware">HW</button>
        </div>
    </div>

    <!-- 4. Feed Module (Main Area) -->
    <div class="dash-feed" id="feed">
        <div class="posts-grid" id="posts-grid">
            {% for post in paginator.posts %}
            <article class="post-card">
                <div class="card-header">
                    <span class="post-date">{{ post.date | date: "%Y.%m.%d" }}</span>
                    {% if post.tags %}
                    <span class="post-tag">{{ post.tags | first | upcase }}</span>
                    {% endif %}
                </div>
                <h3><a href="{{ post.url | relative_url }}">{{ post.title }}</a></h3>
                <p class="post-excerpt">{{ post.excerpt | strip_html | truncate: 120 }}</p>
                <a href="{{ post.url | relative_url }}" class="read-link">ACCESS DATA -></a>
            </article>
            {% endfor %}
        </div>
        
        <!-- Pagination -->
        <div class="pagination">
            {% if paginator.previous_page %}
            <a href="{{ paginator.previous_page_path | relative_url }}" class="btn-nav">< Newer</a>
            {% endif %}
            {% if paginator.next_page %}
            <a href="{{ paginator.next_page_path | relative_url }}" class="btn-nav">Older ></a>
            {% endif %}
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const searchInput = document.getElementById('search-input');
    const grid = document.getElementById('posts-grid');
    const filterTags = document.querySelectorAll('.filter-btn');
    let posts = [];

    // Fetch search index
    fetch('{{ "/search.json" | relative_url }}')
        .then(response => response.json())
        .then(data => {
            posts = data;
        });

    searchInput.addEventListener('input', (e) => {
        const term = e.target.value.toLowerCase();
        // Update active class on filter buttons to "all" if typing? 
        // Or just let it filter.
        filterPosts(term, getActiveCategory());
    });

    filterTags.forEach(tag => {
        tag.addEventListener('click', () => {
            // Visual selection state
            filterTags.forEach(t => t.classList.remove('active'));
            tag.classList.add('active');
            
            const category = tag.dataset.tag.toLowerCase();
            searchInput.value = ''; // Clear search when clicking tag
            filterPosts('', category);
        });
    });

    function getActiveCategory() {
        const activeBtn = document.querySelector('.filter-btn.active');
        return activeBtn ? activeBtn.dataset.tag.toLowerCase() : 'all';
    }

    function filterPosts(term, category) {
        if (!posts.length) return;

        const filtered = posts.filter(post => {
            const matchesSearch = post.title.toLowerCase().includes(term) || 
                                  post.tags.toLowerCase().includes(term) ||
                                  post.excerpt.toLowerCase().includes(term);
            const matchesCategory = category === 'all' || post.tags.toLowerCase().includes(category);
            
            return matchesSearch && matchesCategory;
        });

        renderPosts(filtered);
    }

    function renderPosts(results) {
        if (results.length === 0) {
            grid.innerHTML = '<div class="no-results"><p>NO DATA FOUND</p></div>';
            return;
        }

        grid.innerHTML = results.map(post => `
            <article class="post-card">
                <div class="card-header">
                    <span class="post-date">${post.date.replace(/-/g, '.')}</span>
                    ${post.tags ? `<span class="post-tag">${post.tags.split(', ')[0].toUpperCase()}</span>` : ''}
                </div>
                <h3><a href="${post.url}">${post.title}</a></h3>
                <p class="post-excerpt">${post.excerpt}</p>
                <a href="${post.url}" class="read-link">ACCESS DATA -></a>
            </article>
        `).join('');
    }
});
</script>
